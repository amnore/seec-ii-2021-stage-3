# 软件体系结构文档模板

## 文档修改历史

## 目录

## 1.引言

### 1.1 编制目的

### 1.2 词汇表

### 1.3 参考资料

## 2.产品概述

## 3.逻辑视图

[逻辑视图](./plantuml/logical-view.plantuml)

## 4.组合视图

### 4.1 开发包图

| 开发包      | 依赖        |
| ----------- | ----------- |
| postarea    | postservice |
| postservice | postmapper  |

### 4.2 运行时进程

### 4.3 物理部署

## 5.架构设计

### 5.1 模块职责

### 5.2 用户界面层分解

[用户界面](./plantuml/ui-modules.plantuml)

#### 5.2.1 职责

| 服务名      | 服务                       |
| ----------- | -------------------------- |
| PostArea    | 展示讨论区                 |
| CommentArea | 展示讨论区某条帖子的评论区 |

#### 5.2.2 接口规范

### 5.3 业务逻辑层分解

#### 5.3.1 职责

| 模块           | 职责                                                         |
| -------------- | ------------------------------------------------------------ |
| controller     | 接受 REST 请求并调用 service                                 |
| service.post   | 提供讨论区相关服务，包括获取贴子、获取回复、发表帖子、发表回复 |
| mapper.post    | 提供贴子、回复的增删查改操作                                 |
| CommentService | 提供评论帖子，记录该评论是否通知过接收者的功能               |

#### 5.3.2 接口规范

##### 5.3.2.1 PostService

###### 5.3.2.1.1 提供的服务（供接口）

| 接口名               | 描述                                                                                              |
| -------------------- | ------------------------------------------------------------------------------------------------- |
| PostService.getPosts | **语法** `public List<PostVO> getPosts(Integer classId, Integer page, PostSortMethod sortMethod)` |
|                      | **前置条件** 用户有权限查看该课程贴子，参见 SRS1                                                  |
|                      | **后置条件** 返回对应课程的贴子按照指定方式排序后的指定页所含贴子                                 |

###### 5.3.2.1.2 需要的服务（需接口）

| 服务名                                      | 服务                   |
| ------------------------------------------- | ---------------------- |
| PostMapper.selectByClassId(Integer classId) | 查找指定课程的所有贴子 |

##### 5.3.2.2 CommentService

###### 5.3.2.2.1 提供的服务（供接口）

| 接口名                       | 描述                                                         |
| ---------------------------- | ------------------------------------------------------------ |
| CommentService.addComment    | **语法** `public CommentVO addComment(Integer postId, Integer userID,Integer commentID, String contents, Integer timestamp)` |
|                              | **前置条件** 用户有权限查看该课程贴子，参见 SRS1             |
|                              | **后置条件** 返回comment对象，该条comment写入数据库          |
| CommentService.deleteComment | **语法** `public CommentVO deleteComment(Integer userID,Integer commentID)` |
|                              | **前置条件** 该条评论由删除者创建                            |
|                              | **后置条件** 该条comment从数据库中删除                       |

###### 5.3.2.2.2 需要的服务（需接口）

暂时不考虑

### 5.4 数据层分解

#### 5.4.1 职责

| 服务名            | 服务                   |
| ----------------- | ---------------------- |
| mapper.PostMapper | 提供贴子相关的数据操作 |

#### 5.4.2 接口规范

| 接口名                     | 描述                                                              |
| -------------------------- | ----------------------------------------------------------------- |
| PostMapper.selectByClassId | **语法** `List<Post> PostMapper.selectByClassId(Integer classId)` |
|                            | **前置条件** 指定的课程存在                                       |
|                            | **后置条件** 返回课程的全部贴子                                   |

### 5.5 信息视角

#### 5.5.1 数据持久化对象

|  类名   |   描述   |
| :-----: | :------: |
|  Post   | 贴子信息 |
| Comment | 评论信息 |
|         |          |

详细信息如下图：

![](https://ftp.bmp.ovh/imgs/2021/06/4cfeb25d059540db.jpg)

[持久化对象](./plantuml/persistent-objects.plantuml)

#### 5.5.2 数据库表

comments表：courseID, commentsID，postID, content, authorID, receiverID,  haveInformedReceiver

